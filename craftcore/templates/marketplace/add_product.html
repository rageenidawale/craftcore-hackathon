{% extends "base.html" %}

{% block title %}{% if is_edit %}
      Edit Product
    {% else %}
      Add Product
    {% endif %} | CraftCore{% endblock %}

{% block content %}

<div class="container mt-5 add-product-page" style="max-width: 600px; padding-bottom: 100px;">

  <h4 class="mb-4 text-center">
    {% if is_edit %}
      Edit Product
    {% else %}
      Add Product
    {% endif %}
  </h4>

  {% for message in messages %}
    <div class="alert alert-danger">{{ message }}</div>
  {% endfor %}

  <form method="post" enctype="multipart/form-data" action="{% if is_edit %}/seller/products/{{ product.id }}/edit/{% else %}/seller/products/add/{% endif %}">
    {% csrf_token %}

    <div class="mb-3">
      <label class="form-label">Product Name</label>
      <input type="text" name="name" class="form-control"
       value="{{ product.name|default:'' }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea
        class="form-control"
        name="description"
        rows="4"
        required
      >{{ product.description|default_if_none:"" }}</textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Category</label>
      <select name="category" class="form-select">
        {% for category in categories %}
          <option value="{{ category.id }}"
            {% if product.category.id == category.id %}selected{% endif %}>
            {{ category.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Material Used</label>
      <select name="material" class="form-select">
        {% for material in materials %}
          <option value="{{ material.id }}"
            {% if product.material.id == material.id %}selected{% endif %}>
            {{ material.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Price (â‚¹)</label>
      <input type="number" name="price" class="form-control"
       value="{{ product.price|default:'' }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Stock Quantity</label>
      <input type="number" name="stock" class="form-control"
       value="{{ product.stock|default:'' }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Product Image</label>

      <input
        type="file"
        name="image"
        class="form-control"
        accept="image/*"
        {% if not is_edit %}required{% endif %}
      >

      {% if is_edit %}
        <div class="form-text">
          Leave this blank to keep the existing image.
        </div>
      {% endif %}
    </div>


    <div class="d-grid">
      <button type="submit" class="btn btn-dark submit-button">
        {% if is_edit %}Update Product{% else %}Add Product{% endif %}
      </button>
    </div>

  </form>

</div>

{% endblock %}
